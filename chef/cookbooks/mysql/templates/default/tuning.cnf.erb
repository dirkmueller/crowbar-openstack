[mysqld]
innodb_buffer_pool_size = <%= @innodb_buffer_pool_size %>M
innodb_log_file_size = <%= [8, @innodb_buffer_pool_size / 4].max %>M
innodb_buffer_pool_instances = <%= @innodb_buffer_pool_instances %>

innodb_flush_method = O_DIRECT

# 0 should bring better performance but has slight risk of losing some logs
innodb_flush_log_at_trx_commit = <%= @innodb_flush_log_at_trx_commit %>

max_connections = <%= @max_connections %>
tmp_table_size = <%= @tmp_table_size %>M
max_heap_table_size = <%= @max_heap_table_size %>M

skip_name_resolve = 1

# FIXME: Remove after MariaDB 10.2.X switch (new default is auto)
thread_cache_size = <%= node[:database][:mysql][:tunable][:thread_cache_size] %>
# FIXME: Remove after MariaDB 10.2.X switch (new default is 16777216)
max_allowed_packet = <%= node[:database][:mysql][:tunable][:max_allowed_packet] %>
